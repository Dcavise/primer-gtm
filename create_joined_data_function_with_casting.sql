CREATE OR REPLACE FUNCTION public.get_leads_with_campus_info(limit_count integer DEFAULT 100) RETURNS SETOF json LANGUAGE sql SECURITY DEFINER AS $$ SELECT row_to_json(combined) FROM (SELECT l.*, c.name as campus_name, c.address as campus_address, c.city as campus_city, c.state as campus_state FROM salesforce.lead l LEFT JOIN public.campuses c ON l.campus_c::uuid = c.id LIMIT $1) combined; $$; COMMENT ON FUNCTION public.get_leads_with_campus_info IS 'Get leads with related campus information'; GRANT EXECUTE ON FUNCTION public.get_leads_with_campus_info TO authenticated; GRANT EXECUTE ON FUNCTION public.get_leads_with_campus_info TO service_role;
